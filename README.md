# `libfix64`

A fast 64-bit (Q31.32) fixed point math library written in C99.

Implements basic arithmetic function, comparison, conversion, exponentiation, powers, trigonometry,
and more; including all relevant `math.h` functions for fixed point numbers.

> :information_source: **Note:** This library is still a work in progress. Not all functionality
> is complete yet.

> :information_source: **Note:** This library performs best on 64-bit architectures since
> `libfix64` leverages native 64*64=128-bit multiplication for many functions.
> Fallback implementations are provided for other platforms, but performance will suffer.

## Usage

Part of the source code for this project is autogenerated using a Python script.
This is called under the hood by the CMake build scripts before compiling the generated C code.
Ensure Python 3.6 or later is installed on your system, and install the requirements by running:

~~~sh
python3 -m pip install -U -r requirements.txt
~~~

Configure the project by running:

~~~sh
cmake -S. -Bbuild
~~~

And build the project by running:

~~~sh
cmake --build build --parallel
~~~

## Development

### Implementation

Public headers are located in the [include](include) directory,
while implementations for the few non-inline functions are located in [src](src).
Files with the `.jinja` file extension are templates which are included into the C source code.
These use the [Jinja2] templating language which the Python scripts populate
with things like mathematical constants, etc.

Templates are rendered using the scripts in the [scripts](scripts) directory.
The Python [mpmath] library is used for accurately calculating constants,
since a Python `float` or a C `double` only have 53 bits of precision.

Most non-trivial mathematical functions are calculated using Chebyshev polynomials, although other
algorithms are used for certain functions where polynomial approximations are less suitable.

### Tests

Tests are in the [tests](tests) directory.
These are a collection of executables written in C using [ctest] and link to the compiled library.

To launch the tests, run:

~~~sh
ctest --test-dir build/tests --parallel 8
~~~

[jinja2]: https://palletsprojects.com/p/jinja/
[mpmath]: https://mpmath.org/
[ctest]: https://cmake.org/cmake/help/latest/manual/ctest.1.html
